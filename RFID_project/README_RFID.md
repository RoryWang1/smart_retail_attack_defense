# RFID â€“ Security Playground
*Sideâ€‘byâ€‘side Python demos of **classic attacks** and a **lightâ€‘weight defense** for RFIDâ€‘style protocols.*

---

## Repository Layout

| File | Role |
|------|------|
| **`attacks.py`** | Vulnerable tag/reader implementation **plus 3 attacks** (eavesdrop, replay, clone). |
| **`defense.py`** | Hardened tag/reader with HMACÂ +Â AESâ€‘Fernet, antiâ€‘replay logic, and security logging. |
| **`response.log`** | Raw secret captured by the eavesdrop attack. |
| **`attack.log`** | Alerts generated by `defense.py` whenever an attack is detected. |

---

## 1Â â€“ Prerequisites

```bash
# Python 3.8 or newer
pip install cryptography   # required only for defense.py

# macOS only â€“Â for convenience the scripts alias 127.0.0.2 to the loopâ€‘back interface.
# Run once (or with sudo) if you get â€œaddress not availableâ€:
sudo ifconfig lo0 alias 127.0.0.2
```

---

## 2Â â€“ Attacker Walkâ€‘through (`attacks.py`)

Open **three terminals** so the steps are easy to follow.

###Â 2.1Â Start a vulnerable tagÂ â€“Â TerminalÂ A
```bash
python attacks.py tag --host 127.0.0.2 --port 9999
```

###Â 2.2Â Normal read (baseline)Â â€“Â TerminalÂ B
```bash
python attacks.py reader --tag-host 127.0.0.2 --tag-port 9999
# â†’ static plaintext with PRODUCT_ID / INVENTORY
```

###Â 2.3Â EavesdroppingÂ â€“Â TerminalÂ C
```bash
python attacks.py eavesdrop --host 127.0.0.2 --port 9999
# â†’ response.log now contains sensitive data
```

###Â 2.4Â Replay
```bash
# TerminalÂ C   (vulnerable tag can now be stopped if you like)
python attacks.py replay --port 8888

# TerminalÂ B
python attacks.py reader --tag-host 127.0.0.1 --tag-port 8888
# â†’ reader is fooled by old data coming from fake tag
```

###Â 2.5Â Clone / Tamper
```bash
# Terminal A (real tag back on 9999)
python attacks.py tag --host 127.0.0.2 --port 9999

# TerminalÂ C   
python attacks.py clone --listen-port 8888 --real-host 127.0.0.2 --real-port 9999

# TerminalÂ B
python attacks.py reader --tag-host 127.0.0.1 --tag-port 8888
# â†’ INVENTORY value is silently multiplied by 10
```

---

## 3Â â€“ Defender Walkâ€‘through (`defense.py`)

Open **two terminals** for a quick demo, or reuse the three from above.

###Â 3.1Â Start secure tagÂ â€“Â TerminalÂ A
```bash
python defense.py tag --host 127.0.0.1 --port 9999
```

###Â 3.2Â Normal secure readÂ â€“Â TerminalÂ B
```bash
python defense.py reader --host 127.0.0.1 --port 9999
# â†’ nonce shown, encrypted payload is decrypted on client side
```

---

## 4Â â€“ Oneâ€‘command Attack Tests (against the defense)

All tests automatically print **SUCCESS / FAILURE**  
and append an alert to **`attack.log`**.

| Attack | Command |
|--------|---------|
| Eavesdrop | `python defense.py test-eavesdrop --port 9999` |
| Replay | `python defense.py test-replay --port 9999` |
| Clone / MITM | `python defense.py test-clone --port 9999 --clone-port 8888` |

After running the trio:

```bash
tail -n 20 attack.log
# expect entries for: invalidÂ HMAC, replayÂ attack, tamperedÂ ciphertext
```

---

## 5Â â€“ How the Defense Works (very short)

| Layer | Technique (inÂ `defense.py`) |
|-------|-----------------------------|
| **Authentication** | HMACâ€‘SHA256 over oneâ€‘time nonce (`compute_hmac`) |
| **Confidentiality** | AESâ€‘Fernet encrypts payload before transmission |
| **Integrity** | Second HMAC over nonce + ciphertext |
| **Replay guard** | `used_nonces` and `used_hmacs` sets reject duplicates |
| **Monitoring** | `log_alert()` writes all violations to **`attack.log`** |

---

## 6Â â€“ Cleanup

```bash
rm response.log attack.log 2>/dev/null

# macOS only, if you created the alias
sudo ifconfig lo0 -alias 127.0.0.2
```

---

Happy hacking! ğŸ”’ğŸ”‘

