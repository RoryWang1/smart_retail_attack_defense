# RFID – Security Playground
*Side‑by‑side Python demos of **classic attacks** and a **light‑weight defense** for RFID‑style protocols.*

---

## Repository Layout

| File | Role |
|------|------|
| **`attacks.py`** | Vulnerable tag/reader implementation **plus 3 attacks** (eavesdrop, replay, clone). |
| **`defense.py`** | Hardened tag/reader with HMAC + AES‑Fernet, anti‑replay logic, and security logging. |
| **`response.log`** | Raw secret captured by the eavesdrop attack. |
| **`attack.log`** | Alerts generated by `defense.py` whenever an attack is detected. |

---

## 1 – Prerequisites

```bash
# Python 3.8 or newer
pip install cryptography   # required only for defense.py

# macOS only – for convenience the scripts alias 127.0.0.2 to the loop‑back interface.
# Run once (or with sudo) if you get “address not available”:
sudo ifconfig lo0 alias 127.0.0.2
```

---

## 2 – Attacker Walk‑through (`attacks.py`)

Open **three terminals** so the steps are easy to follow.

### 2.1 Start a vulnerable tag – Terminal A
```bash
python attacks.py tag --host 127.0.0.2 --port 9999
```

### 2.2 Normal read (baseline) – Terminal B
```bash
python attacks.py reader --tag-host 127.0.0.2 --tag-port 9999
# → static plaintext with PRODUCT_ID / INVENTORY
```

### 2.3 Eavesdropping – Terminal C
```bash
python attacks.py eavesdrop --host 127.0.0.2 --port 9999
# → response.log now contains sensitive data
```

### 2.4 Replay
```bash
# Terminal C   (vulnerable tag can now be stopped if you like)
python attacks.py replay --port 8888

# Terminal B
python attacks.py reader --tag-host 127.0.0.1 --tag-port 8888
# → reader is fooled by old data coming from fake tag
```

### 2.5 Clone / Tamper
```bash
# Terminal A (real tag back on 9999)
python attacks.py tag --host 127.0.0.2 --port 9999

# Terminal C   
python attacks.py clone --listen-port 8888 --real-host 127.0.0.2 --real-port 9999

# Terminal B
python attacks.py reader --tag-host 127.0.0.1 --tag-port 8888
# → INVENTORY value is silently multiplied by 10
```

---

## 3 – Defender Walk‑through (`defense.py`)

Open **two terminals** for a quick demo, or reuse the three from above.

### 3.1 Start secure tag – Terminal A
```bash
python defense.py tag --host 127.0.0.1 --port 9999
```

### 3.2 Normal secure read – Terminal B
```bash
python defense.py reader --host 127.0.0.1 --port 9999
# → nonce shown, encrypted payload is decrypted on client side
```

---

## 4 – One‑command Attack Tests (against the defense)

All tests automatically print **SUCCESS / FAILURE**  
and append an alert to **`attack.log`**.

| Attack | Command |
|--------|---------|
| Eavesdrop | `python defense.py test-eavesdrop --port 9999` |
| Replay | `python defense.py test-replay --port 9999` |
| Clone / MITM | `python defense.py test-clone --port 9999 --clone-port 8888` |

After running the trio:

```bash
tail -n 20 attack.log
# expect entries for: invalid HMAC, replay attack, tampered ciphertext
```

---

## 5 – How the Defense Works (very short)

| Layer | Technique (in `defense.py`) |
|-------|-----------------------------|
| **Authentication** | HMAC‑SHA256 over one‑time nonce (`compute_hmac`) |
| **Confidentiality** | AES‑Fernet encrypts payload before transmission |
| **Integrity** | Second HMAC over nonce + ciphertext |
| **Replay guard** | `used_nonces` and `used_hmacs` sets reject duplicates |
| **Monitoring** | `log_alert()` writes all violations to **`attack.log`** |

---

## 6 – Cleanup

```bash
rm response.log attack.log 2>/dev/null

# macOS only, if you created the alias
sudo ifconfig lo0 -alias 127.0.0.2
```

---

Happy hacking! 🔒🔑

